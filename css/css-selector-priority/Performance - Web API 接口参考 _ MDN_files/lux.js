var LUX=LUX||{};LUX.samplerate=10;var LUX=LUX||{};LUX.samplerate=10;var LUX_t_start=Date.now();LUX=(function(){dlog("lux.js evaluation start.");var version="201";var _label=_getPageLabel();var _errorUrl="https://lux.speedcurve.com/error/";var sError="";var nErrors=0;var maxErrors=5;function errorHandler(e){nErrors++;if(e&&"undefined"!==typeof(e.filename)&&"undefined"!==typeof(e.message)){if((-1!==e.filename.indexOf("/lux.js?")||-1!==e.message.indexOf("LUX"))||(nErrors<=maxErrors&&"function"===typeof(_sample)&&_sample())){_label=_getPageLabel();new Image().src=_errorUrl+"?v="+version+"&id="+getCustomerId()+"&fn="+encodeURIComponent(e.filename)+"&ln="+e.lineno+"&cn="+e.colno+"&msg="+encodeURIComponent(e.message)+"&l="+encodeURIComponent(_label)+(connectionType()?"&ct="+connectionType():"")+""}}}window.addEventListener("error",errorHandler);var gaPerfEntries=("object"===typeof(LUX_al)?LUX_al.slice():[]);if("function"===typeof(PerformanceObserver)&&"function"===typeof(PerformanceLongTaskTiming)){var perfObserver=new PerformanceObserver(function(list){var perfEntries=list.getEntries();for(var i=0;i<perfEntries.length;i++){var p=perfEntries[i];gaPerfEntries.push(p)}});try{perfObserver.observe({type:"longtask"});if("function"===typeof(LargestContentfulPaint)){perfObserver.observe({type:"largest-contentful-paint",buffered:true})}if("function"===typeof(PerformanceElementTiming)){perfObserver.observe({type:"element",buffered:true})}if("function"===typeof(PerformancePaintTiming)){perfObserver.observe({type:"paint",buffered:true})}}catch(e){dlog("Long Tasks error.")}}else{dlog("Long Tasks not supported.")}var gFlags=0;var gFlag_InitCalled=1;var gFlag_NoNavTiming=2;var gFlag_NoUserTiming=4;var gFlag_NotVisible=8;var gaMarks=("undefined"!==typeof(LUX)&&"undefined"!==typeof(LUX.gaMarks)?LUX.gaMarks:[]);var gaMeasures=("undefined"!==typeof(LUX)&&"undefined"!==typeof(LUX.gaMeasures)?LUX.gaMeasures:[]);var ghIx={};var ghData={};var gbLuxSent=0;var gbNavSent=0;var gbIxSent=0;var gbUpdated=0;var gbFirstPV=1;var gStartMark="LUX_start";var gEndMark="LUX_end";var gSessionTimeout=30*60;var gSyncId=createSyncId();var gUid=refreshUniqueId(gSyncId);var gCustomerDataTimeout;var perf=window.performance;var gMaxQuerystring=2000;var _beaconUrl=("undefined"!==typeof(LUX)&&LUX.beaconUrl?LUX.beaconUrl:"https://lux.speedcurve.com/lux/");var _samplerate=("undefined"!==typeof(LUX)&&"undefined"!==typeof(LUX.samplerate)?LUX.samplerate:100);dlog("Sample rate = "+_samplerate+"%. "+(_sample()?"This session IS being sampled. The data WILL show up in your LUX dashboards.":"This session is NOT being sampled. The data will NOT show up in your LUX dashboards. Call LUX.forceSample() and try again."));var _auto=("undefined"!==typeof(LUX)&&"undefined"!==typeof(LUX.auto)?LUX.auto:true);var _navigationStart=("undefined"!==typeof(LUX)&&LUX.ns?LUX.ns:(Date.now?Date.now():+(new Date())));var gLuxSnippetStart=0;if(perf&&perf.timing&&perf.timing.navigationStart){_navigationStart=perf.timing.navigationStart;gLuxSnippetStart=("undefined"!==typeof(LUX)&&LUX.ns?LUX.ns-_navigationStart:0)}else{dlog("Nav Timing is not supported.");gFlags=gFlags|gFlag_NoNavTiming}var gFirstInputDelay;var gaEventTypes=["click","mousedown","keydown","touchstart","pointerdown"];var ghListenerOptions={passive:true,capture:true};function recordDelay(delay,evt){if(!gFirstInputDelay){gFirstInputDelay=Math.round(delay);gaEventTypes.forEach(function(eventType){removeEventListener(eventType,onInput,ghListenerOptions)})}}function onPointerDown(delay,evt){function onPointerUp(){recordDelay(delay,evt);removeListeners()}function onPointerCancel(){removeListeners()}function removeListeners(){removeEventListener("pointerup",onPointerUp,ghListenerOptions);removeEventListener("pointercancel",onPointerCancel,ghListenerOptions)}addEventListener("pointerup",onPointerUp,ghListenerOptions);addEventListener("pointercancel",onPointerCancel,ghListenerOptions)}function onInput(evt){var bCancelable=false;try{bCancelable=evt.cancelable}catch(e){dlog("Permission error accessing input event.");return}if(bCancelable){var now=_now();var eventTimeStamp=evt.timeStamp;if(eventTimeStamp>1520000000){now=Number(new Date())}if(eventTimeStamp>now){return}var delay=now-eventTimeStamp;if("pointerdown"==evt.type){onPointerDown(delay,evt)}else{recordDelay(delay,evt)}}}gaEventTypes.forEach(function(eventType){addEventListener(eventType,onInput,ghListenerOptions)});function _now(){if(perf&&perf.now){return perf.now()}var n=Date.now?Date.now():+(new Date());return n-_navigationStart}function _mark(name){dlog("Enter LUX.mark(), name = "+name);if(perf){if(perf.mark){return perf.mark(name)}else{if(perf.webkitMark){return perf.webkitMark(name)}}}gFlags=gFlags|gFlag_NoUserTiming;gaMarks.push({name:name,entryType:"mark",startTime:_now(),duration:0});return}function _measure(name,startMarkName,endMarkName){dlog("Enter LUX.measure(), name = "+name);if("undefined"===typeof(startMarkName)&&_getMark(gStartMark)){startMarkName=gStartMark}if(perf){if(perf.measure){if(startMarkName){if(endMarkName){return perf.measure(name,startMarkName,endMarkName)}else{return perf.measure(name,startMarkName)}}else{return perf.measure(name)}}else{if(perf.webkitMeasure){return perf.webkitMeasure(name,startMarkName,endMarkName)}}}var startTime=0,endTime=_now();if(startMarkName){var startMark=_getMark(startMarkName);if(startMark){startTime=startMark.startTime}else{if(perf&&perf.timing&&perf.timing[startMarkName]){startTime=perf.timing[startMarkName]-perf.timing.navigationStart}else{return}}}if(endMarkName){var endMark=_getMark(endMarkName);if(endMark){endTime=endMark.startTime}else{if(perf&&perf.timing&&perf.timing[endMarkName]){endTime=perf.timing[endMarkName]-perf.timing.navigationStart}else{return}}}gaMeasures.push({name:name,entryType:"measure",startTime:startTime,duration:(endTime-startTime)});return}function _getMark(name){return _getM(name,_getMarks())}function _getMeasure(name){return _getM(name,_getMeasures())}function _getM(name,aItems){if(aItems){for(i=aItems.length-1;i>=0;i--){var m=aItems[i];if(name===m.name){return m}}}return undefined}function _getMarks(){if(perf){if(perf.getEntriesByType){return perf.getEntriesByType("mark")}else{if(perf.webkitGetEntriesByType){return perf.webkitGetEntriesByType("mark")}}}return gaMarks}function _getMeasures(){if(perf){if(perf.getEntriesByType){return perf.getEntriesByType("measure")}else{if(perf.webkitGetEntriesByType){return perf.webkitGetEntriesByType("measure")}}}return gaMeasures}function _clearMarks(name){if(perf&&perf.clearMarks){return perf.clearMarks(name)}if(name){for(i=gaMarks.length-1;i>=0;i--){if(name===gaMarks[i].name){gaMarks.splice(i,1)}}}else{gaMarks=[]}return}function _clearMeasures(name){if(perf&&perf.clearMeasures){return perf.clearMeasures(name)}if(name){for(i=gaMeasures.length-1;i>=0;i--){if(name===gaMeasures[i].name){gaMeasures.splice(i,1)}}}else{gaMeasures=[]}return}function userTimingValues(){var hUT={};var aItems=_getMarks();if(aItems){for(var i=0,len=aItems.length;i<len;i++){var m=aItems[i],name=m.name,t=Math.round(m.startTime);if("undefined"===typeof(hUT[name])){hUT[name]=t}else{hUT[name]=Math.max(t,hUT[name])}}}aItems=_getMeasures();if(aItems){for(var i=0,len=aItems.length;i<len;i++){var m=aItems[i],name=m.name,t=Math.round(m.duration);if("undefined"===typeof(hUT[name])){hUT[name]=t}else{hUT[name]=Math.max(t,hUT[name])}}}var aUT=[];var aNames=Object.keys(hUT);if(aNames){for(var i=0,len=aNames.length;i<len;i++){var name=aNames[i];aUT.push(name+"|"+hUT[name])}}return aUT.join(",")}function elementTimingValues(){var aET=[];if(gaPerfEntries.length){for(var i=0;i<gaPerfEntries.length;i++){var pe=gaPerfEntries[i];if("element"===pe.entryType&&pe.identifier&&pe.startTime){aET.push(pe.identifier+"|"+Math.round(pe.startTime))}}}return aET.join(",")}function cpuTimes(){if("function"!==typeof(PerformanceLongTaskTiming)){return""}var sCPU="";var hCPU={};var hCPUDetails={};if(gaPerfEntries.length){var tZero=(_getMark(gStartMark)?_getMark(gStartMark).startTime:0);var tEnd=(_getMark(gStartMark)?_getMark(gEndMark).startTime:perf.timing.loadEventEnd-perf.timing.navigationStart);for(var i=0;i<gaPerfEntries.length;i++){var p=gaPerfEntries[i];if("longtask"!==p.entryType){continue}var dur=Math.round(p.duration);if(p.startTime<tZero){dur-=tZero-p.startTime}else{if(p.startTime>=tEnd){continue}}var type=p.attribution[0].name;if(!hCPU[type]){hCPU[type]=0;hCPUDetails[type]=""}hCPU[type]+=dur;hCPUDetails[type]+=","+Math.round(p.startTime)+"|"+dur}}var jsType=("undefined"!==typeof(hCPU.script)?"script":"unknown");if("undefined"===typeof(hCPU[jsType])){hCPU[jsType]=0;hCPUDetails[jsType]=""}var hStats=cpuStats(hCPUDetails[jsType]);var sStats=",n|"+hStats.count+",d|"+hStats.median+",x|"+hStats.max+(0===hStats.fci?"":",i|"+hStats.fci);sCPU+="s|"+hCPU[jsType]+sStats+hCPUDetails[jsType];return sCPU}function cpuStats(sDetails){var max=0;var fci=getFcp();var bFoundFci=(0===fci?true:false);var aValues=[];var aTuples=sDetails.split(",");for(var i=0;i<aTuples.length;i++){var aTuple=aTuples[i].split("|");if(aTuple.length===2){var start=parseInt(aTuple[0]);var dur=parseInt(aTuple[1]);aValues.push(dur);max=(dur>max?dur:max);if(!bFoundFci&&start>fci){if(start-fci>5000){bFoundFci=true}else{fci=start+dur}}}}var count=aValues.length;var median=arrayMedian(aValues);return{count:count,median:median,max:max,fci:fci}}function arrayMedian(aValues){if(0===aValues.length){return 0}var half=Math.floor(aValues.length/2);aValues.sort(function(a,b){return a-b});if(aValues.length%2){return aValues[half]}else{return Math.round((aValues[half-1]+aValues[half])/2)}}function selfLoading(){var sLuxjs="";if(perf&&perf.getEntriesByName){var luxScript=getScriptElement("/js/lux.js");if(luxScript){var aResources=perf.getEntriesByName(luxScript.src);if(aResources&&aResources.length){var r=aResources[0];var dns=Math.round(r.domainLookupEnd-r.domainLookupStart);var tcp=Math.round(r.connectEnd-r.connectStart);var fb=Math.round(r.responseStart-r.requestStart);var content=Math.round(r.responseEnd-r.responseStart);var networkDuration=dns+tcp+fb+content;var parseEval=LUX_t_end-LUX_t_start;var transferSize=(r.encodedBodySize?r.encodedBodySize:0);sLuxjs="d"+dns+"t"+tcp+"f"+fb+"c"+content+"n"+networkDuration+"e"+parseEval+"r"+_samplerate+(transferSize?"x"+transferSize:"")+(gLuxSnippetStart?"l"+gLuxSnippetStart:"")+"s"+(LUX_t_start-_navigationStart)+""}}}return sLuxjs}function _clearIx(){ghIx={}}function ixValues(){var aIx=[];for(var key in ghIx){aIx.push(key+"|"+ghIx[key])}return aIx.join(",")}function _addData(name,value){dlog("Enter LUX.addData(), name = "+name+", value = "+value);var typeN=typeof(name);var typeV=typeof(value);if("string"===typeN&&("string"===typeV||"number"===typeV||"boolean"===typeV)){ghData[name]=value}if(gbLuxSent){if(gCustomerDataTimeout){clearTimeout(gCustomerDataTimeout)}gCustomerDataTimeout=setTimeout(_sendCustomerData,100)}}function _sample(){if("undefined"===typeof(gUid)||"undefined"===typeof(_samplerate)){return false}var nThis=(""+gUid).substr(-2);return(parseInt(nThis)<_samplerate)}function customerDataValues(){var aData=[];for(var key in ghData){var value=""+ghData[key];key=key.replace(/,/g,"").replace(/\|/g,"");value=value.replace(/,/g,"").replace(/\|/g,"");aData.push(key+"|"+value)}return encodeURIComponent(aData.join(","))}function _init(){dlog("Enter LUX.init().");_clearMarks();_clearMeasures();_clearIx();_removeIxHandlers();_addIxHandlers();_label=_getPageLabel();gbNavSent=0;gbLuxSent=0;gbIxSent=0;gbFirstPV=0;gSyncId=createSyncId();gUid=refreshUniqueId(gSyncId);gaPerfEntries.splice(0);gFlags=0;gFlags=gFlags|gFlag_InitCalled;_mark(gStartMark)}function blockingScripts(){var lastViewportElem=lastViewportElement();if(!lastViewportElem){return syncScripts()}var aElems=document.getElementsByTagName("script");var num=0;for(var i=0,len=aElems.length;i<len;i++){var e=aElems[i];if(e.src&&!e.async&&!e.defer&&0!==(e.compareDocumentPosition(lastViewportElem)&4)){num++}}return num}function blockingStylesheets(){var nBlocking=0;var aElems=document.getElementsByTagName("link");for(var i=0,len=aElems.length;i<len;i++){var e=aElems[i];if(e.href&&"stylesheet"===e.rel&&0!==e.href.indexOf("data:")){if(e.onloadcssdefined||"print"===e.media||"style"===e.as||("function"===typeof(e.onload)&&"all"===e.media)){}else{nBlocking++}}}return nBlocking}function syncScripts(){var aElems=document.getElementsByTagName("script");var num=0;for(var i=0,len=aElems.length;i<len;i++){var e=aElems[i];if(e.src&&!e.async&&!e.defer){num++}}return num}function numScripts(){var aElems=document.getElementsByTagName("script");var num=0;for(var i=0,len=aElems.length;i<len;i++){var e=aElems[i];if(e.src){num++}}return num}function numStylesheets(){var aElems=document.getElementsByTagName("link");var num=0;for(var i=0,len=aElems.length;i<len;i++){var e=aElems[i];if(e.href&&"stylesheet"==e.rel){num++}}return num}function inlineTagSize(tagName){var aElems=document.getElementsByTagName(tagName);var size=0;for(var i=0,len=aElems.length;i<len;i++){var e=aElems[i];try{size+=e.innerHTML.length}catch(e){dlog("Error accessing inline element innerHTML.");return -1}}return size}function getNavTiming(){var s="";var ns=_navigationStart;if(_getMark(gStartMark)&&_getMark(gEndMark)){var start=Math.round(_getMark(gStartMark).startTime);ns+=start;var end=Math.round(_getMark(gEndMark).startTime)-start;s=ns+"fs"+0+"ls"+end+"le"+end+""}else{if(perf&&perf.timing){var t=perf.timing;var startRender=getStartRender();var fcp=getFcp();var lcp=getLcp();s=ns+(t.redirectStart?"rs"+(t.redirectStart-ns):"")+(t.redirectEnd?"re"+(t.redirectEnd-ns):"")+(t.fetchStart?"fs"+(t.fetchStart-ns):"")+(t.domainLookupStart?"ds"+(t.domainLookupStart-ns):"")+(t.domainLookupEnd?"de"+(t.domainLookupEnd-ns):"")+(t.connectStart?"cs"+(t.connectStart-ns):"")+(t.secureConnectionStart?"sc"+(t.secureConnectionStart-ns):"")+(t.connectEnd?"ce"+(t.connectEnd-ns):"")+(t.requestStart?"qs"+(t.requestStart-ns):"")+(t.responseStart?"bs"+(t.responseStart-ns):"")+(t.responseEnd?"be"+(t.responseEnd-ns):"")+(t.domLoading?"ol"+(t.domLoading-ns):"")+(t.domInteractive?"oi"+(t.domInteractive-ns):"")+(t.domContentLoadedEventStart?"os"+(t.domContentLoadedEventStart-ns):"")+(t.domContentLoadedEventEnd?"oe"+(t.domContentLoadedEventEnd-ns):"")+(t.domComplete?"oc"+(t.domComplete-ns):"")+(t.loadEventStart?"ls"+(t.loadEventStart-ns):"")+(t.loadEventEnd?"le"+(t.loadEventEnd-ns):"")+(startRender?"sr"+startRender:"")+(fcp?"fc"+fcp:"")+(lcp?"lc"+lcp:"")+""}else{if(_getMark(gEndMark)){var end=Math.round(_getMark(gEndMark).startTime);s=ns+"fs"+0+"ls"+end+"le"+end+""}}}return s}function getFcp(){if(perf&&perf.getEntriesByType&&perf.getEntriesByType("paint")){for(var arr=perf.getEntriesByType("paint"),i=0;i<arr.length;i++){var ppt=arr[i];if("first-contentful-paint"===ppt.name){return Math.round(ppt.startTime)}}}return 0}function getLcp(){if(gaPerfEntries.length){for(var i=gaPerfEntries.length-1;i>=0;i--){var pe=gaPerfEntries[i];if("largest-contentful-paint"===pe.entryType){return Math.round(pe.startTime)}}}return 0}function getStartRender(){if(perf&&perf.timing){var t=perf.timing;var ns=t.navigationStart;var startRender;if(ns){if(perf&&perf.getEntriesByType&&perf.getEntriesByType("paint")&&perf.getEntriesByType("paint").length){for(var arr=perf.getEntriesByType("paint"),i=0;i<arr.length;i++){var ppt=arr[i];if("first-paint"===ppt.name){startRender=Math.round(ppt.startTime);break}}}else{if(window.chrome&&"function"===typeof(window.chrome.loadTimes)){var loadTimes=window.chrome.loadTimes();if(loadTimes){startRender=Math.round((loadTimes.firstPaintTime*1000)-ns)}}else{if(t.msFirstPaint){startRender=Math.round(t.msFirstPaint-ns)}}}var onload=(t.loadEventStart-ns);if(startRender&&startRender<onload+1000){return startRender}}}dlog("Paint Timing not supported.");return null}function getCustomerId(){if("undefined"!==typeof(LUX)&&LUX.customerid){return LUX.customerid}var luxScript=getScriptElement("/js/lux.js");if(luxScript){LUX.customerid=getQuerystringParam(luxScript.src,"id");return LUX.customerid}return""}function getScriptElement(urlsnippet){var aScripts=document.getElementsByTagName("script");for(var i=0,len=aScripts.length;i<len;i++){var script=aScripts[i];if(script.src&&-1!==script.src.indexOf(urlsnippet)){return script}}return null}function getQuerystringParam(url,name){var qs=url.split("?")[1];var aTuples=qs.split("&");for(var i=0,len=aTuples.length;i<len;i++){var tuple=aTuples[i];var aTuple=tuple.split("=");var key=aTuple[0];if(name===key){return aTuple[1]}}return undefined}function avgDomDepth(){var aElems=document.getElementsByTagName("*");var i=aElems.length;var totalParents=0;while(i--){totalParents+=numParents(aElems[i])}var average=Math.round(totalParents/aElems.length);return average}function numParents(elem){var n=0;if(elem.parentNode){while(elem=elem.parentNode){n++}}return n}function docHeight(doc){var body=doc.body,docelem=doc.documentElement;var height=Math.max((body?body.scrollHeight:0),(body?body.offsetHeight:0),(docelem?docelem.clientHeight:0),(docelem?docelem.scrollHeight:0),(docelem?docelem.offsetHeight:0));return height}function docWidth(doc){var body=doc.body,docelem=doc.documentElement;var width=Math.max((body?body.scrollWidth:0),(body?body.offsetWidth:0),(docelem?docelem.clientWidth:0),(docelem?docelem.scrollWidth:0),(docelem?docelem.offsetWidth:0));return width}function docSize(){if(perf&&perf.getEntriesByType){var aEntries=performance.getEntriesByType("navigation");if(aEntries&&aEntries.length>0&&aEntries[0]["encodedBodySize"]){return aEntries[0]["encodedBodySize"]}}return 0}function navigationType(){if(perf&&perf.navigation&&"undefined"!=typeof(perf.navigation.type)){return perf.navigation.type}return""}function connectionType(){var c=navigator.connection;var connType="";if(c&&c.effectiveType){connType=c.effectiveType;if("slow-2g"===connType){connType="Slow 2G"}else{if("2g"===connType||"3g"===connType||"4g"===connType||"5g"===connType){connType=connType.toUpperCase()}else{connType=connType.charAt(0).toUpperCase()+connType.slice(1)}}}return connType}function imagesATF(){var aImages=document.getElementsByTagName("img");var aImagesAtf=[];if(aImages){for(var i=0,len=aImages.length;i<len;i++){var image=aImages[i];if(inViewport(image)){aImagesAtf.push(image)}}}return aImagesAtf}function lastViewportElement(parent){if(!parent){parent=document.body}var lastChildInViewport;if(parent){var aChildren=parent.children;if(aChildren){for(var i=0,len=aChildren.length;i<len;i++){var child=aChildren[i];if(inViewport(child)){lastChildInViewport=child}}}}if(lastChildInViewport){return lastViewportElement(lastChildInViewport)}else{return parent}}function inViewport(e){var vh=document.documentElement.clientHeight;var vw=document.documentElement.clientWidth;var lt=findPos(e);return(lt[0]>=0&&lt[1]>=0&&lt[0]<vw&&lt[1]<vh&&e.offsetWidth>0&&e.offsetHeight>0)}function findPos(e){var curleft=curtop=0;while(e){curleft+=e.offsetLeft;curtop+=e.offsetTop;e=e.offsetParent}return[curleft,curtop]}function _sendLux(){dlog("Enter LUX.send().");var customerid=getCustomerId();if(!customerid||!gSyncId||!validDomain()||!_sample()||gbLuxSent){return}_mark(gEndMark);var sUT=userTimingValues();var sET=elementTimingValues();var sCustomerData=customerDataValues();var sIx="";if(!gbIxSent){sIx=ixValues()}var sCPU=cpuTimes();var sLuxjs=selfLoading();if(document.visibilityState&&"visible"!==document.visibilityState){gFlags=gFlags|gFlag_NotVisible}_label=_getPageLabel();var baseUrl=_beaconUrl+"?v="+version+"&id="+customerid+"&sid="+gSyncId+"&uid="+gUid+(sCustomerData?"&CD="+sCustomerData:"")+"&l="+encodeURIComponent(_label);var is=inlineTagSize("script");var ic=inlineTagSize("style");var querystring=(gbNavSent?"":"&NT="+getNavTiming())+(gbFirstPV?"&LJS="+sLuxjs:"")+"&PS=ns"+numScripts()+"bs"+blockingScripts()+(is>-1?"is"+is:"")+"ss"+numStylesheets()+"bc"+blockingStylesheets()+(ic>-1?"ic"+ic:"")+"ia"+imagesATF().length+"it"+document.getElementsByTagName("img").length+"dd"+avgDomDepth()+"nd"+document.getElementsByTagName("*").length+"vh"+document.documentElement.clientHeight+"vw"+document.documentElement.clientWidth+"dh"+docHeight(document)+"dw"+docWidth(document)+(docSize()?"ds"+docSize():"")+(connectionType()?"ct"+connectionType()+"_":"")+"er"+nErrors+"nt"+navigationType()+(navigator.deviceMemory?"dm"+Math.round(navigator.deviceMemory):"")+(sIx?"&IX="+sIx:"")+(gFirstInputDelay?"&FID="+gFirstInputDelay:"")+(sCPU?"&CPU="+sCPU:"")+(gFlags?"&fl="+gFlags:"")+(sET?"&ET="+sET:"")+"&HN="+encodeURIComponent(document.location.hostname)+"";var sUT_remainder="";if(sUT){var curLen=baseUrl.length+querystring.length;if(curLen+sUT.length<=gMaxQuerystring){querystring+="&UT="+sUT}else{var avail=gMaxQuerystring-curLen;var iComma=sUT.lastIndexOf(",",avail);querystring+="&UT="+sUT.substring(0,iComma);sUT_remainder=sUT.substring(iComma+1)}}var beaconUrl=baseUrl+querystring;dlog("Sending main LUX beacon: "+beaconUrl);_sendBeacon(beaconUrl);gbLuxSent=1;gbNavSent=1;gbIxSent=sIx;var avail=gMaxQuerystring-baseUrl.length;while(sUT_remainder){var sUT_cur="";if(sUT_remainder.length<=avail){sUT_cur=sUT_remainder;sUT_remainder=""}else{var iComma=sUT_remainder.lastIndexOf(",",avail);if(-1===iComma){iComma=sUT_remainder.indexOf(",")}if(-1===iComma){sUT_cur=sUT_remainder;sUT_remainder=""}else{sUT_cur=sUT_remainder.substring(0,iComma);sUT_remainder=sUT_remainder.substring(iComma+1)}}var beaconUrl=baseUrl+"&UT="+sUT_cur;dlog("Sending extra User Timing beacon: "+beaconUrl);_sendBeacon(beaconUrl)}}function _sendIx(){var customerid=getCustomerId();if(!customerid||!gSyncId||!validDomain()||!_sample()||gbIxSent||!gbLuxSent){return}var sIx=ixValues();if(sIx){var sCustomerData=customerDataValues();var querystring="?v="+version+"&id="+customerid+"&sid="+gSyncId+"&uid="+gUid+(sCustomerData?"&CD="+sCustomerData:"")+"&l="+encodeURIComponent(_label)+"&IX="+sIx+(gFirstInputDelay?"&FID="+gFirstInputDelay:"")+"&HN="+encodeURIComponent(document.location.hostname)+"";var beaconUrl=_beaconUrl+querystring;dlog("Sending Interaction Metrics beacon: "+beaconUrl);_sendBeacon(beaconUrl);gbIxSent=1}}function _sendCustomerData(){var customerid=getCustomerId();if(!customerid||!gSyncId||!validDomain()||!_sample()||!gbLuxSent){return}var sCustomerData=customerDataValues();if(sCustomerData){var querystring="?v="+version+"&id="+customerid+"&sid="+gSyncId+"&uid="+gUid+"&CD="+sCustomerData+"&l="+encodeURIComponent(_label)+"&HN="+encodeURIComponent(document.location.hostname)+"";var beaconUrl=_beaconUrl+querystring;dlog("Sending late Customer Data beacon: "+beaconUrl);_sendBeacon(beaconUrl)}}function _sendBeacon(url){var s1=document.createElement("script");s1.async=true;s1.src=url;var aElems=document.getElementsByTagName("script");if(aElems.length){aElems[0].parentNode.insertBefore(s1,aElems[0])}else{aElems=document.getElementsByTagName("head");if(aElems.length){aElems[0].appendChild(s1)}else{aElems=document.getElementsByTagName("body");if(aElems.length){aElems[0].appendChild(s1)}}}}function _findTrackedElement(elem,firstId,bAttrFound){if(!elem||!elem.hasAttribute){return firstId}if(elem.hasAttribute("data-sctrack")){bAttrFound=true;if(elem.id){firstId=elem.id}}if(!firstId&&elem.id){firstId=elem.id}if(bAttrFound&&firstId){return firstId}return _findTrackedElement(elem.parentNode,firstId,bAttrFound)}function _scrollHandler(){if("undefined"===typeof(ghIx.s)){ghIx.s=Math.round(_now())}}function _keyHandler(e){_removeIxHandlers();if("undefined"===typeof(ghIx.k)){ghIx.k=Math.round(_now());if(e&&e.target){var trackId=_findTrackedElement(e.target);if(trackId){ghIx.ki=trackId}}_sendIx()}}function _clickHandler(e){_removeIxHandlers();if("undefined"===typeof(ghIx.c)){ghIx.c=Math.round(_now());var target=null;try{if(e&&e.target){target=e.target}}catch(e){dlog("Error accessing event target.");target=null}if(target){if(e.clientX){ghIx.cx=e.clientX;ghIx.cy=e.clientY}var trackId=_findTrackedElement(e.target);if(trackId){ghIx.ci=trackId}}_sendIx()}}function _doUpdate(newestVer,twiddle){if(newestVer&&version<newestVer&&document.body&&!gbUpdated){dlog("Updating cached version of lux.js from "+version+" to "+newestVer+".");gbUpdated=1;var luxScript=getScriptElement("/js/lux.js");if(luxScript){if("function"===typeof(fetch)){fetch(luxScript.src,{cache:"reload"})}else{var iframe1=document.createElement("iframe");iframe1.style.display="none";iframe1.id="LUX_update_iframe";iframe1.src="//cdn.speedcurve.com/luxupdate.php?src="+encodeURIComponent(luxScript.src)+(twiddle?"&tw="+twiddle:"");document.body.appendChild(iframe1)}}}}function addListener(eventName,callback){if(window.addEventListener){window.addEventListener(eventName,callback,false)}else{if(window.attachEvent){window.attachEvent("on"+eventName,callback)}}}function removeListener(eventName,callback){if(window.removeEventListener){window.removeEventListener(eventName,callback,false)}else{if(window.detachEvent){window.detachEvent("on"+eventName,callback)}}}function _addIxHandlers(){addListener("scroll",_scrollHandler);addListener("keypress",_keyHandler);addListener("mousedown",_clickHandler)}function _removeIxHandlers(){removeListener("scroll",_scrollHandler);removeListener("keypress",_keyHandler);removeListener("mousedown",_clickHandler)}function createSyncId(bInSampleBucket){var syncId=(bInSampleBucket?Number(new Date())+"00000":Number(new Date())+""+_padLeft(parseInt(100000*Math.random()),"00000"));return syncId}function refreshUniqueId(newValue){var uid=_getCookie("lux_uid");if(!uid||uid.length<11){uid=newValue}else{var uidStart=parseInt(uid.substring(0,10));var now=Number(new Date())/1000;if(now-uidStart>(24*60*60)){uid=newValue}}setUniqueId(uid);return uid}function setUniqueId(uid){_setCookie("lux_uid",uid,gSessionTimeout);return uid}function _getUniqueId(){return gUid}function _getPageLabel(){if("undefined"!==typeof(LUX)&&"undefined"!==typeof(LUX.label)){return LUX.label}else{if("undefined"!==typeof(LUX.jspagelabel)){try{return eval(LUX.jspagelabel)}catch(e){console.error("Error evaluating customer settings LUX page label:",e)}}}return document.title}function validDomain(){return true}function _getCookie(name){try{var aTuples=document.cookie.split(";");for(var i=0;i<aTuples.length;i++){var aTuple=aTuples[i].split("=");if(name===aTuple[0].trim()){return unescape(aTuple[1])}}}catch(e){dlog("Error accessing document.cookie.")}return undefined}function _setCookie(name,value,seconds){try{document.cookie=name+"="+escape(value)+(seconds?"; max-age="+seconds:"")+"; path=/"}catch(e){dlog("Error setting document.cookie.")}}function _padLeft(str,padding){return(padding+str).slice(-padding.length)}function dlog(msg){if("undefined"===typeof(gaLog)){gaLog=[]}gaLog.push(msg);if("undefined"!==typeof(LUX)&&LUX.debug){console.log("LUX: "+msg)}}if(_auto){if("complete"==document.readyState){_sendLux()}else{addListener("load",function(){setTimeout(_sendLux,200)})}addListener("beforeunload",_sendLux);addListener("unload",_sendLux);addListener("beforeunload",_sendIx);addListener("unload",_sendIx)}_addIxHandlers();var _LUX={mark:_mark,measure:_measure,init:_init,send:_sendLux,addData:_addData,getSessionId:_getUniqueId,getDebug:function(){return gaLog},forceSample:function(){setUniqueId(createSyncId(true));console.log("Sampling has been turned on for this session.")},doUpdate:_doUpdate,cmd:function(args){var fn=args.shift();if("function"===typeof(_LUX[fn])){_LUX[fn].apply(_LUX,args)}},beaconUrl:_beaconUrl,samplerate:_samplerate,auto:_auto,label:_label,version:version,ae:[],al:[],debug:("undefined"!==typeof(LUX)&&LUX.debug?true:false)};if(window.LUX&&LUX.ac&&LUX.ac.length){for(var i=0;i<LUX.ac.length;i++){var args=LUX.ac[i];var fn=args.shift();if("function"===typeof(_LUX[fn])){_LUX[fn].apply(_LUX,args)}}}for(var i=0;"object"===typeof(LUX_ae)&&i<LUX_ae.length;i++){errorHandler(LUX_ae[i])}dlog("lux.js evaluation end.");return _LUX})();var LUX_t_end=Date.now();